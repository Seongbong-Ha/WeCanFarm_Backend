# ğŸŒ± WeCanFarm Server

> **ë†ì‘ë¬¼ ì§ˆë³‘ AI ë¶„ì„ ì„œë¹„ìŠ¤**  
> YOLO ê°ì²´ ê°ì§€ì™€ ResNet ì§ˆë³‘ ë¶„ë¥˜ë¥¼ ê²°í•©í•œ ìŠ¤ë§ˆíŠ¸ ë†ì—… ì†”ë£¨ì…˜

## ğŸ“‹ ëª©ì°¨

- [í”„ë¡œì íŠ¸ ê°œìš”](#-í”„ë¡œì íŠ¸-ê°œìš”)
- [ì£¼ìš” ê¸°ëŠ¥](#-ì£¼ìš”-ê¸°ëŠ¥)
- [ê¸°ìˆ  ìŠ¤íƒ](#-ê¸°ìˆ -ìŠ¤íƒ)
- [ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜](#-ì‹œìŠ¤í…œ-ì•„í‚¤í…ì²˜)
- [ì„¤ì¹˜ ë° ì‹¤í–‰](#-ì„¤ì¹˜-ë°-ì‹¤í–‰)
- [API ë¬¸ì„œ](#-api-ë¬¸ì„œ)
- [í”„ë¡œì íŠ¸ êµ¬ì¡°](#-í”„ë¡œì íŠ¸-êµ¬ì¡°)
- [ì‚¬ìš©ë²•](#-ì‚¬ìš©ë²•)
- [ê°œë°œ ê°€ì´ë“œ](#-ê°œë°œ-ê°€ì´ë“œ)

## ğŸ¯ í”„ë¡œì íŠ¸ ê°œìš”

WeCanFarmì€ ë†ì‘ë¬¼ ì´ë¯¸ì§€ë¥¼ ë¶„ì„í•˜ì—¬ ì§ˆë³‘ì„ ìë™ìœ¼ë¡œ ì§„ë‹¨í•˜ëŠ” AI ê¸°ë°˜ ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤. ë†ë¶€ë“¤ì´ ìŠ¤ë§ˆíŠ¸í°ìœ¼ë¡œ ì‘ë¬¼ ì‚¬ì§„ì„ ì°ìœ¼ë©´, AIê°€ ì§ˆë³‘ì„ ê°ì§€í•˜ê³  ì§„ë‹¨ ê²°ê³¼ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

### ğŸ”¬ AI ëª¨ë¸ íŒŒì´í”„ë¼ì¸

1. **YOLO v8**: ì´ë¯¸ì§€ì—ì„œ ì‘ë¬¼ ê°ì²´ë¥¼ ê°ì§€í•˜ê³  ìœ„ì¹˜ë¥¼ íŒŒì•…
2. **ResNet**: ê°ì§€ëœ ì‘ë¬¼ ì˜ì—­ì˜ ì§ˆë³‘ì„ ë¶„ë¥˜ ë° ì§„ë‹¨
3. **ê²°ê³¼ ì‹œê°í™”**: ë°”ìš´ë”© ë°•ìŠ¤ì™€ ì§ˆë³‘ ì •ë³´ë¥¼ ì˜¤ë²„ë ˆì´

## âœ¨ ì£¼ìš” ê¸°ëŠ¥

### ğŸ” **ì´ë¯¸ì§€ ë¶„ì„**
- **ì „ì²´ íŒŒì´í”„ë¼ì¸**: YOLO ê°ì²´ ê°ì§€ + ResNet ì§ˆë³‘ ë¶„ë¥˜
- **ë‹¨ì¼ ë¶„ì„**: ResNetì„ ì‚¬ìš©í•œ ì§ì ‘ ì§ˆë³‘ ë¶„ë¥˜
- **ë‹¤ì¤‘ ê°ì²´ ì§€ì›**: í•œ ì´ë¯¸ì§€ì—ì„œ ì—¬ëŸ¬ ì‘ë¬¼ ë™ì‹œ ë¶„ì„

### ğŸŒ **ì›¹ ì¸í„°í˜ì´ìŠ¤**
- ì§ê´€ì ì¸ ì´ë¯¸ì§€ ì—…ë¡œë“œ UI
- ì‹¤ì‹œê°„ ë¶„ì„ ê²°ê³¼ í‘œì‹œ
- ë¶„ì„ ë°©ì‹ ì„ íƒ (ì „ì²´/ë‹¨ì¼)

### ğŸ“± **ëª¨ë°”ì¼ API**
- RESTful API ì—”ë“œí¬ì¸íŠ¸
- Base64 ì´ë¯¸ì§€ ì—…ë¡œë“œ ì§€ì›
- JSON í˜•íƒœì˜ êµ¬ì¡°í™”ëœ ì‘ë‹µ

### ğŸ‘¨â€ğŸ’¼ **ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ**
- ì‹¤ì‹œê°„ ì„œë¹„ìŠ¤ í†µê³„
- ì‚¬ìš©ì ë° ë¶„ì„ í˜„í™©
- ì§ˆë³‘ë³„/ì‘ë¬¼ë³„ ë¶„ì„ ë°ì´í„°

## ğŸ›  ê¸°ìˆ  ìŠ¤íƒ

### **Backend**
- **FastAPI**: ê³ ì„±ëŠ¥ ì›¹ í”„ë ˆì„ì›Œí¬
- **Pydantic**: ë°ì´í„° ê²€ì¦ ë° ì§ë ¬í™”
- **SQLAlchemy**: ORM ë° ë°ì´í„°ë² ì´ìŠ¤ ê´€ë¦¬

### **AI/ML**
- **TensorFlow/Keras**: ë”¥ëŸ¬ë‹ ëª¨ë¸ ì¶”ë¡ 
- **Ultralytics YOLO**: ê°ì²´ ê°ì§€
- **PIL/OpenCV**: ì´ë¯¸ì§€ ì²˜ë¦¬

### **Frontend**
- **Jinja2**: ì„œë²„ì‚¬ì´ë“œ í…œí”Œë¦¿
- **HTML/CSS/JavaScript**: ì›¹ UI
- **Chart.js**: ë°ì´í„° ì‹œê°í™”

### **Database**
- **SQLite/PostgreSQL**: ë°ì´í„° ì €ì¥
- **Alembic**: ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜

## ğŸ— ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

```
ğŸŒ External Interface (ì›¹/ëª¨ë°”ì¼/ê´€ë¦¬ì)
         â†“
ğŸš€ FastAPI Application (main.py)
         â†“
ğŸ›£ï¸ Router Layer (webanalyze, analyze, admin)
         â†“
âš™ï¸ Service Layer (pipeline, inference, model_manager)
         â†“
ğŸ› ï¸ Utility Layer (image_handler) + ğŸ¤– AI Models (YOLO, ResNet)
         â†“
ğŸ—„ï¸ Data Layer (database, schemas)
```

## ğŸš€ ì„¤ì¹˜ ë° ì‹¤í–‰

### **1. í™˜ê²½ ìš”êµ¬ì‚¬í•­**
- Python 3.8+
- CUDA (GPU ì‚¬ìš© ì‹œ)
- 8GB+ RAM ê¶Œì¥

### **2. í”„ë¡œì íŠ¸ í´ë¡ **
```bash
git clone https://github.com/your-repo/WeCanFarm_Server.git
cd WeCanFarm_Server
```

### **3. ê°€ìƒí™˜ê²½ ì„¤ì •**
```bash
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate
```

### **4. ì˜ì¡´ì„± ì„¤ì¹˜**
```bash
pip install -r requirements.txt
```

### **5. AI ëª¨ë¸ ë‹¤ìš´ë¡œë“œ**
```bash
# ëª¨ë¸ íŒŒì¼ì„ app/models/ ë””ë ‰í† ë¦¬ì— ë°°ì¹˜
mkdir -p app/models
# yolo_v1.pt, pepper_disease_model.keras íŒŒì¼ ë³µì‚¬
```

### **6. ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™”**
```bash
alembic upgrade head
```

### **7. ì„œë²„ ì‹¤í–‰**
```bash
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

### **8. ì ‘ì† í™•ì¸**
- ì›¹ UI: http://localhost:8000
- API ë¬¸ì„œ: http://localhost:8000/docs
- ê´€ë¦¬ì: http://localhost:8000/admin

## ğŸ“š API ë¬¸ì„œ

### **ì „ì²´ íŒŒì´í”„ë¼ì¸ ë¶„ì„**
```http
POST /analyze
Content-Type: application/json

{
  "image_base64": "data:image/jpeg;base64,/9j/4AAQ..."
}
```

**ì‘ë‹µ:**
```json
{
  "image_base64": "ê²°ê³¼_ì´ë¯¸ì§€_base64",
  "detections": [
    {
      "bbox": [x1, y1, x2, y2],
      "crop_type": "pepper",
      "disease_status": "ê³ ì¶”ì ë¬´ëŠ¬ë³‘",
      "disease_confidence": 0.92,
      "yolo_confidence": 0.85,
      "label": "pepper: ê³ ì¶”ì ë¬´ëŠ¬ë³‘"
    }
  ],
  "total_detections": 1
}
```

### **ë‹¨ì¼ ì‘ë¬¼ ë¶„ì„**
```http
POST /analyze_single?crop_type=pepper
Content-Type: application/json

{
  "image_base64": "data:image/jpeg;base64,/9j/4AAQ..."
}
```

**ì‘ë‹µ:**
```json
{
  "crop_type": "pepper",
  "disease_status": "ì •ìƒ",
  "confidence": 0.94
}
```

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
WeCanFarm_Server/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ main.py                 # FastAPI ë©”ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜
â”‚   â”œâ”€â”€ routers/               # API ë¼ìš°í„°
â”‚   â”‚   â”œâ”€â”€ analyze.py         # ë¶„ì„ API
â”‚   â”‚   â”œâ”€â”€ webanalyze.py      # ì›¹ UI ë¼ìš°í„°
â”‚   â”‚   â””â”€â”€ admin.py           # ê´€ë¦¬ì ë¼ìš°í„°
â”‚   â”œâ”€â”€ services/              # ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
â”‚   â”‚   â”œâ”€â”€ pipeline.py        # ì´ë¯¸ì§€ ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸
â”‚   â”‚   â”œâ”€â”€ inference.py       # AI ëª¨ë¸ ì¶”ë¡ 
â”‚   â”‚   â””â”€â”€ model_manager.py   # ëª¨ë¸ ê´€ë¦¬
â”‚   â”œâ”€â”€ utils/                 # ìœ í‹¸ë¦¬í‹°
â”‚   â”‚   â””â”€â”€ image_handler.py   # ì´ë¯¸ì§€ ì²˜ë¦¬ ë„êµ¬
â”‚   â”œâ”€â”€ database/              # ë°ì´í„°ë² ì´ìŠ¤
â”‚   â”‚   â”œâ”€â”€ models.py          # ORM ëª¨ë¸
â”‚   â”‚   â””â”€â”€ database.py        # DB ì—°ê²°
â”‚   â”œâ”€â”€ schemas/               # ë°ì´í„° ìŠ¤í‚¤ë§ˆ
â”‚   â”‚   â””â”€â”€ request_response.py
â”‚   â”œâ”€â”€ templates/             # HTML í…œí”Œë¦¿
â”‚   â”‚   â”œâ”€â”€ index.html
â”‚   â”‚   â”œâ”€â”€ pipeline_result.html
â”‚   â”‚   â”œâ”€â”€ single_result.html
â”‚   â”‚   â”œâ”€â”€ error.html
â”‚   â”‚   â””â”€â”€ admin_dashboard.html
â”‚   â”œâ”€â”€ models/                # AI ëª¨ë¸ íŒŒì¼
â”‚   â”‚   â”œâ”€â”€ yolo_v1.pt
â”‚   â”‚   â””â”€â”€ pepper_disease_model.keras
â”‚   â””â”€â”€ static/                # ì •ì  íŒŒì¼
â”œâ”€â”€ requirements.txt           # Python ì˜ì¡´ì„±
â”œâ”€â”€ alembic.ini               # DB ë§ˆì´ê·¸ë ˆì´ì…˜ ì„¤ì •
â””â”€â”€ README.md                 # í”„ë¡œì íŠ¸ ë¬¸ì„œ
```

## ğŸ’¡ ì‚¬ìš©ë²•

### **ì›¹ ë¸Œë¼ìš°ì €ì—ì„œ**
1. http://localhost:8000 ì ‘ì†
2. ì‘ë¬¼ ì´ë¯¸ì§€ ì—…ë¡œë“œ
3. ë¶„ì„ ë°©ì‹ ì„ íƒ (ì „ì²´ íŒŒì´í”„ë¼ì¸/ë‹¨ì¼ ë¶„ì„)
4. ê²°ê³¼ í™•ì¸

### **ëª¨ë°”ì¼ ì•±ì—ì„œ**
1. ì´ë¯¸ì§€ë¥¼ Base64ë¡œ ì¸ì½”ë”©
2. `/analyze` ë˜ëŠ” `/analyze_single` API í˜¸ì¶œ
3. JSON ì‘ë‹µ íŒŒì‹±í•˜ì—¬ ê²°ê³¼ í‘œì‹œ

### **ê´€ë¦¬ìë¡œì„œ**
1. http://localhost:8000/admin ì ‘ì†
2. ì‹¤ì‹œê°„ ì„œë¹„ìŠ¤ í†µê³„ í™•ì¸
3. ì‚¬ìš©ì ë° ë¶„ì„ í˜„í™© ëª¨ë‹ˆí„°ë§

## ğŸ”§ ê°œë°œ ê°€ì´ë“œ

### **ìƒˆë¡œìš´ ì‘ë¬¼ ëª¨ë¸ ì¶”ê°€**

1. **ëª¨ë¸ íŒŒì¼ ì¶”ê°€**
   ```bash
   # app/models/ì— ìƒˆ ëª¨ë¸ íŒŒì¼ ë°°ì¹˜
   cp tomato_disease_model.keras app/models/
   ```

2. **ModelManager ì—…ë°ì´íŠ¸**
   ```python
   # app/services/model_manager.py
   def _load_tomato_model(self):
       """í† ë§ˆí†  ëª¨ë¸ ë¡œë“œ"""
       model_path = os.path.join(os.path.dirname(__file__), '../models/tomato_disease_model.keras')
       # ... ëª¨ë¸ ë¡œë”© ë¡œì§
   ```

3. **í´ë˜ìŠ¤ ë¼ë²¨ ì •ì˜**
   ```python
   self.class_labels['tomato'] = {
       0: "early_blight",
       1: "late_blight",
       2: "normal"
   }
   ```

### **ìƒˆë¡œìš´ API ì—”ë“œí¬ì¸íŠ¸ ì¶”ê°€**

1. **ë¼ìš°í„° ìƒì„±**
   ```python
   # app/routers/new_feature.py
   from fastapi import APIRouter
   router = APIRouter(prefix="/new_feature")
   
   @router.get("/endpoint")
   async def new_endpoint():
       return {"message": "Hello World"}
   ```

2. **ë©”ì¸ ì•±ì— ë“±ë¡**
   ```python
   # app/main.py
   from .routers import new_feature
   app.include_router(new_feature.router)
   ```

### **ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ë³€ê²½**

1. **ëª¨ë¸ ìˆ˜ì •**
   ```python
   # app/database/models.pyì—ì„œ ëª¨ë¸ ìˆ˜ì •
   ```

2. **ë§ˆì´ê·¸ë ˆì´ì…˜ ìƒì„±**
   ```bash
   alembic revision --autogenerate -m "Add new column"
   ```

3. **ë§ˆì´ê·¸ë ˆì´ì…˜ ì ìš©**
   ```bash
   alembic upgrade head
   ```

### **í…ŒìŠ¤íŠ¸ ì‹¤í–‰**

```bash
# ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
pytest tests/

# íŠ¹ì • í…ŒìŠ¤íŠ¸
pytest tests/test_inference.py

# ì»¤ë²„ë¦¬ì§€ ì¸¡ì •
pytest --cov=app tests/
```

### **ì½”ë“œ í’ˆì§ˆ ê²€ì‚¬**

```bash
# ì½”ë“œ í¬ë§·íŒ…
black app/

# ë¦°íŒ…
flake8 app/

# íƒ€ì… ì²´í¬
mypy app/
```

## ğŸ¤ ê¸°ì—¬í•˜ê¸°

1. Fork the Project
2. Create your Feature Branch (`git checkout -b feature/AmazingFeature`)
3. Commit your Changes (`git commit -m 'Add some AmazingFeature'`)
4. Push to the Branch (`git push origin feature/AmazingFeature`)
5. Open a Pull Request

## ğŸ“„ ë¼ì´ì„ ìŠ¤

ì´ í”„ë¡œì íŠ¸ëŠ” MIT ë¼ì´ì„ ìŠ¤ í•˜ì— ë°°í¬ë©ë‹ˆë‹¤. ìì„¸í•œ ë‚´ìš©ì€ `LICENSE` íŒŒì¼ì„ ì°¸ì¡°í•˜ì„¸ìš”.

## ğŸ“ ì§€ì› ë° ë¬¸ì˜

- **ì´ìŠˆ ë¦¬í¬íŠ¸**: [GitHub Issues](https://github.com/your-repo/WeCanFarm_Server/issues)
- **ì´ë©”ì¼**: support@wecanfarm.com
- **ë¬¸ì„œ**: [Wiki](https://github.com/your-repo/WeCanFarm_Server/wiki)

## ğŸ† í¬ë ˆë”§

- **AI ëª¨ë¸**: YOLOv8 (Ultralytics), ResNet (TensorFlow)
- **ì›¹ í”„ë ˆì„ì›Œí¬**: FastAPI
- **ê°œë°œíŒ€**: WeCanFarm Team

---

**Made with â¤ï¸ by WeCanFarm Team**